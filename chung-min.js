function wait(){waitforme=document.getElementById("pleasewait");waitforme.style.display="block"}function done(){waitforme=document.getElementById("pleasewait");waitforme.style.display="none"}function run_engine(){wait();var k=document.getElementById('placeholder');var l=document.getElementById("hoverdata");k.style.display='none';l.style.display='none';P=$("#ps").val();Q=$("#qs").val();Kc=$("#Kc").val();ti=$("#ti").val();td=$("#td").val();horizon=$('#horizon').val();sim_points=$('#simpoints').val();delay=$("#delay").val();closed_loop=!$("#open").is(':checked');excitation=$('#selectInputSignal option:selected').text().trim().toLowerCase();frequency=$("#freq").val();if(ti=='infty'){Pc="["+(Kc*td)+" "+Kc+"]";Qc="[1]"}else{Pc="["+(Kc*ti*td)+" "+(Kc*ti)+" "+Kc+"]";Qc="["+ti+" 0]"}var m='/engine/smt9901.php?id=example&write_to_file=1&P='+encodeURIComponent(P)+'&Q='+encodeURIComponent(Q)+'&Pm=1&Qm=1&Pc='+encodeURIComponent(Pc)+'&Qc='+encodeURIComponent(Qc)+'&delay='+delay+"&closed_loop="+(closed_loop?"1":"0")+"&excitation="+excitation;if(horizon!='auto'){m+='&sim_horizon='+horizon}if(sim_points!='auto'){m+='&sim_points='+(parseInt(sim_points)>5000?5000:sim_points)}if(excitation=='harmonic'){m+='&frequency='+frequency}$.ajax({url:m,type:'GET',error:function(){alert('FAILURE!!!')},success:function(){}}).done(function(d){var e=d.response;if(!e.success){alert("Error:\n"+e.error)}var f=[];time=e.t;y=e.y;for(var i=0;i<time.length;i+=1){f.push([time[i],y[i]])}var g={series:{lines:{show:true},points:{show:false}},legend:{noColumns:2},grid:{hoverable:true,clickable:true},selection:{mode:"x"}};var h=$("#placeholder");h.bind("plotselected",function(a,b){j=$.plot(h,[f],$.extend(true,{},g,{xaxis:{min:b.xaxis.from,max:b.xaxis.to}}))});h.bind("plothover",function(a,b,c){$("#x").text(b.x.toFixed(3));$("#y").text(b.y.toFixed(4))});k.style.display='block';k.style.width='95%';k.style.marginLeft='20px';k.style.marginTop='30px';var j=$.plot(h,[{data:f,label:'Step Response'}],g);j.draw();l.style.display='block';done()})};function loadMe(){if(document.getElementsByClassName==undefined){document.getElementsByClassName=function(a){var b=new RegExp("(?:^|\\s)"+a+"(?:$|\\s)");var c=document.getElementsByTagName("*");var d=[];var e;for(var i=0;(e=c[i])!=null;i++){var f=e.className;if(f&&f.indexOf(a)!=-1&&b.test(f))d.push(e)}return d}}}function checkNumeric(a){var b=a.value;if(b.length==0){document.getElementById("sb").disabled=true;a.className='error'}else{if(isNumeric(b)==true){document.getElementById("sb").disabled=false;a.className='normal'}else{document.getElementById("sb").disabled=true;a.className='error'}}}function checkSign(a,b){var c=a.value;if(c.length==0){document.getElementById("sb").disabled=true;a.className='errortiny'}else{var d=false;if(b==1){d=isNumeric(c)==true&&c>0}else if(b==0){d=isNumeric(c)==true&&c>=0}else{d=isNumeric(c)}if(d){document.getElementById("sb").disabled=false;a.className='tinyInput'}else{document.getElementById("sb").disabled=true;a.className='errortiny'}}}function checkTi(a){var b=a.value;if(b.length==0){document.getElementById("sb").disabled=true;a.className='error'}else{if(isNumeric(b)==true||b=='infty'){document.getElementById("sb").disabled=false;a.className='normal'}else{document.getElementById("sb").disabled=true;a.className='error'}}}function isNumeric(x){return!isNaN(parseFloat(x))&&isFinite(x)}function openLoopAction(a){if(a.checked){document.getElementById("flowcharthref").href="PIDS2.png";document.images.flowchart.src="PIDS2.png";document.getElementById("openLoopHint").innerHTML="<span class=\"hotspot\" onmouseover=\"tooltip.show(\'Uncheck this box to run simulations on the closed loop system (see figure)\');\" onmouseout=\"tooltip.hide();\">Open Loop</span>"}else{document.getElementById("flowcharthref").href="PIDS.png";document.getElementById("flowcharthref").href="PIDS.png";document.images.flowchart.src="PIDS.png";document.getElementById("openLoopHint").innerHTML="<span class=\"hotspot\" onmouseover=\"tooltip.show(\'Check this box to run simulations on the open loop system (see figure)\');\" onmouseout=\"tooltip.hide();\">Open Loop</span>"}}function newPopup(a){popupWindow=window.open(a,'popUpWindow','height=250,width=500,left=10,top=10,resizable=yes,scrollbars=yes,toolbar=no,menubar=no,location=no,directories=no,status=no')}function showAdvanced(){var a=document.getElementById("advancedOptionsText");var b=document.getElementById("advOptions");var c=document.getElementById("simulationParameters");var d=document.getElementById('step');var e=document.getElementById('harmonic');if(b.style.display!="none"){b.style.display="none";a.innerHTML="Show Advanced Options";d.style.display="none";e.style.display="none";c.style.display="none"}else{b.style.display="inherit";a.innerHTML="Hide Advanced Options";d.style.display="block";c.style.display="block";signalParameters(document.getElementById("selectInputSignal"))}}function signalParameters(a){var b=a.options[a.selectedIndex].value;var c=document.getElementById('step');var d=document.getElementById('harmonic');if(b=="1"){c.style.display="block";d.style.display="none"}else if(b=="2"){d.style.display="none";c.style.display="none"}else if(b=="3"){d.style.display="block";c.style.display="none"}}function highlight(a){a.className="highlighted"}function dehighlight(a){a.className="navLink"}(function(d,s,a){var b,fjs=d.getElementsByTagName(s)[0];if(d.getElementById(a))return;b=d.createElement(s);b.id=a;b.src="//connect.facebook.net/en_US/all.js#xfbml=1";fjs.parentNode.insertBefore(b,fjs)}(document,'script','facebook-jssdk'));!function(d,s,a){var b,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(a)){b=d.createElement(s);b.id=a;b.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(b,fjs)}}(document,"script","twitter-wjs");function highlightButton(){var a=document.getElementById("exclamation");a.style.display="block"}function dehighlightButton(){var a=document.getElementById("exclamation");a.style.display="none"}